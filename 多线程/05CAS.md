Java并发包中有这样一个包，java.util.concurrent.atomic，该包是对Java部分数据类型的原子封装，在原有的基础上提供了原子性的操作方法，保证了线程安全。以AtomicInteger类为例，类中使用了incrementAndGet和decrementAndGet方法封装了++i和--i，保证了操作的原子性，方法中就是使用的cas来保证的原子性。

## CAS
Compare And Swap，比较并交换，是一种无锁原子算法。CAS包含**三个参数(V,E,N)**。V表示要更新变量的值，E表示预期值，N代表新值，仅当 V值等于E值时，才会将V的值设为N，如果V值和E值不同，则说明已经有其他线程做两个更新，则当前线程则什么都不做。最后，CAS 返回当前V的真实值。CAS是一种**乐观锁**，它总是认为自己可以成功完成操作。

当多个线程同时使用CAS 操作一个变量时，只有一个会胜出，并成功更新，其余均会失败。失败的线程不会挂起，仅是被告知失败，并且允许再次尝试，当然也允许实现的线程放弃操作。基于这样的原理，CAS 操作即使没有锁，也可以发现其他线程对当前线程的干扰。




## CAS的问题
### ABA问题
一个线程取出值后，把值从A该为了B，又改回了A，另一个线程看值还是A，就以为值没有变继续执行了，此时就可能出现问题。